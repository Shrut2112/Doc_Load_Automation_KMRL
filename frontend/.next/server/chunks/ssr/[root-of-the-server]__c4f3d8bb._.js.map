{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///D:/project_va/Kochi-Metro/frontend/app/documents/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, useMemo } from 'react';\r\nimport { useSearchParams } from 'next/navigation';\r\nimport {\r\n    FileText, Settings, LogOut, Search, ChevronDown, Loader2, Upload, X, ArrowUp, ArrowDown, FileImage,\r\n    LayoutDashboard, FolderKanban, BarChart2, CheckSquare, Globe, ListChecks, DollarSign\r\n} from 'lucide-react';\r\nimport Link from 'next/link';\r\n\r\n// Base URL for backend API with safe fallback for client-side usage\r\nconst API_BASE = (process.env.NEXT_PUBLIC_API_BASE_URL ?? 'http://127.0.0.1:8000').replace(/\\/+$/, '');\r\n\r\n// --- (1) UPDATE THE DOCUMENT TYPE to include the new ML-generated fields ---\r\ntype Document = {\r\n    id: string; // The UUID from the backend is a string\r\n    title: string;\r\n    department: string;\r\n    upload_date: string;\r\n    file_path: string; // The public URL from Supabase\r\n    status: string;\r\n    summary?: string;\r\n    deadlines?: string[];\r\n    financial_terms?: string[];\r\n};\r\n\r\n// --- Reusable Components ---\r\n\r\nconst NavLink = ({ href, icon, children, isActive }: { href: string; icon: React.ReactNode; children: React.ReactNode; isActive: boolean; }) => (\r\n    <Link href={href} className={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors duration-200 ${isActive ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-400 hover:bg-gray-800 hover:text-white'}`}>\r\n        {icon}\r\n        <span className=\"font-medium\">{children}</span>\r\n    </Link>\r\n);\r\n\r\n// --- (4) ENHANCE THE MODAL to display the new ML data ---\r\nconst DocumentViewerModal = ({ doc, onClose }: { doc: Document; onClose: () => void; }) => {\r\n    const [activeTab, setActiveTab] = useState<'summary' | 'original'>('summary');\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 animate-fade-in\">\r\n            <div className=\"bg-gray-900 w-full h-full md:w-11/12 md:h-5/6 md:rounded-lg shadow-2xl flex flex-col\">\r\n                <header className=\"flex justify-between items-center p-4 border-b border-gray-700 flex-shrink-0\">\r\n                    <div>\r\n                        <h3 className=\"text-xl font-bold text-white\">{doc.title}</h3>\r\n                        <p className=\"text-sm text-gray-400\">{doc.department} &bull; {doc.upload_date}</p>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <div className=\"bg-gray-800 p-1 rounded-lg flex gap-1\">\r\n                            <button\r\n                                onClick={() => setActiveTab('summary')}\r\n                                className={`px-3 py-1 text-sm rounded-md ${activeTab === 'summary' ? 'bg-blue-600 text-white' : 'text-gray-300 hover:bg-gray-700'}`}\r\n                            >\r\n                                Summary & Details\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setActiveTab('original')}\r\n                                className={`px-3 py-1 text-sm rounded-md ${activeTab === 'original' ? 'bg-blue-600 text-white' : 'text-gray-300 hover:bg-gray-700'}`}\r\n                            >\r\n                                Original Document\r\n                            </button>\r\n                        </div>\r\n                        <button onClick={onClose} className=\"text-gray-400 hover:text-white bg-gray-800 p-2 rounded-full\"><X size={20} /></button>\r\n                    </div>\r\n                </header>\r\n                <main className=\"flex-1 overflow-y-auto p-6 text-gray-300\">\r\n                    {activeTab === 'summary' && (\r\n                        <div className=\"space-y-8\">\r\n                            <div>\r\n                                <h4 className=\"text-lg font-semibold text-white mb-3 flex items-center gap-2\"><FileText size={20} /> AI Generated Summary</h4>\r\n                                <p className=\"prose prose-invert max-w-none\">{doc.summary || 'No summary available.'}</p>\r\n                            </div>\r\n\r\n                            {(doc.deadlines && doc.deadlines.length > 0) && (\r\n                                <div>\r\n                                    <h4 className=\"text-lg font-semibold text-white mb-3 flex items-center gap-2\"><ListChecks size={20} /> Deadlines / Key Dates</h4>\r\n                                    <ul className=\"list-disc pl-5 space-y-1\">\r\n                                        {doc.deadlines.map((deadline, index) => <li key={index}>{deadline}</li>)}\r\n                                    </ul>\r\n                                </div>\r\n                            )}\r\n\r\n                            {(doc.financial_terms && doc.financial_terms.length > 0) && (\r\n                                <div>\r\n                                    <h4 className=\"text-lg font-semibold text-white mb-3 flex items-center gap-2\"><DollarSign size={20} /> Financial Terms</h4>\r\n                                     <ul className=\"list-disc pl-5 space-y-1\">\r\n                                        {doc.financial_terms.map((term, index) => <li key={index}>{term}</li>)}\r\n                                    </ul>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                    {activeTab === 'original' && (\r\n                        doc.file_path ? (\r\n                            <iframe src={doc.file_path} className=\"w-full h-full bg-white rounded-md\" title={doc.title}></iframe>\r\n                        ) : (\r\n                            <div className=\"flex flex-col items-center justify-center h-full text-gray-500\">\r\n                                <FileImage size={64} />\r\n                                <p className=\"mt-4\">No original document preview available.</p>\r\n                            </div>\r\n                        )\r\n                    )}\r\n                </main>\r\n            </div>\r\n        </div>\r\n    )\r\n};\r\n\r\n// --- Main Documents Page Component ---\r\nexport default function DocumentsPage() {\r\n    const searchParams = useSearchParams();\r\n\r\n    const [documents, setDocuments] = useState<Document[]>([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    // Sort key is now a string to match the updated Document type\r\n    const [sortConfig, setSortConfig] = useState<{ key: keyof Document; direction: 'asc' | 'desc' }>({ key: 'upload_date', direction: 'desc' });\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [showUploadModal, setShowUploadModal] = useState(false);\r\n    const [selectedDoc, setSelectedDoc] = useState<Document | null>(null);\r\n\r\n    const [deptSlug, setDeptSlug] = useState<string>('operations');\r\n    const [isAdmin, setIsAdmin] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const init = async () => {\r\n            setIsLoading(true);\r\n            const urlDept = (searchParams.get('dept') || '').toLowerCase();\r\n            let storedUser: any = null;\r\n            try {\r\n                storedUser = typeof window !== 'undefined' ? JSON.parse(localStorage.getItem('kmrl_user') || 'null') : null;\r\n            } catch { }\r\n            const admin = storedUser?.isAdmin || urlDept === 'admin';\r\n            setIsAdmin(admin);\r\n            setDeptSlug(admin ? 'admin' : (storedUser?.deptSlug || urlDept || 'operations'));\r\n\r\n            try {\r\n                let fetchUrl = '';\r\n                if (admin) {\r\n                    fetchUrl = `${API_BASE}/documents/?skip=0&limit=100`;\r\n                } else {\r\n                    const deptToFetch = storedUser?.department || 'Operations';\r\n                    fetchUrl = `${API_BASE}/documents/${encodeURIComponent(deptToFetch)}`;\r\n                }\r\n\r\n                const response = await fetch(fetchUrl);\r\n                if (!response.ok) {\r\n                    throw new Error('Failed to fetch documents');\r\n                }\r\n                const backendDocs = await response.json();\r\n\r\n                // --- (2) FIX THE DATA MAPPING: Use the real data from the backend ---\r\n                const mappedDocs: Document[] = (backendDocs || []).map((d: any) => ({\r\n                    id: d.id,\r\n                    title: d.title,\r\n                    department: d.department,\r\n                    upload_date: d.upload_date ? new Date(d.upload_date).toISOString().slice(0, 10) : 'N/A',\r\n                    file_path: d.file_path,\r\n                    status: d.status,\r\n                    summary: d.summary,\r\n                    deadlines: d.deadlines || [],\r\n                    financial_terms: d.financial_terms || [],\r\n                }));\r\n                // --- END OF FIX ---\r\n\r\n                setDocuments(mappedDocs);\r\n\r\n            } catch (err) {\r\n                console.error(err);\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        };\r\n        init();\r\n    }, [searchParams]);\r\n\r\n    // This logic can be simplified as filtering is done on the frontend for now\r\n    const sortedAndFilteredDocuments = useMemo(() => {\r\n        let sortedDocs = [...documents];\r\n        if (sortConfig.key) {\r\n            sortedDocs.sort((a, b) => {\r\n                if (a[sortConfig.key]! < b[sortConfig.key]!) return sortConfig.direction === 'asc' ? -1 : 1;\r\n                if (a[sortConfig.key]! > b[sortConfig.key]!) return sortConfig.direction === 'asc' ? 1 : -1;\r\n                return 0;\r\n            });\r\n        }\r\n        if (searchTerm) {\r\n            return sortedDocs.filter(doc => doc.title.toLowerCase().includes(searchTerm.toLowerCase()));\r\n        }\r\n        return sortedDocs;\r\n    }, [documents, sortConfig, searchTerm]);\r\n\r\n    const requestSort = (key: keyof Document) => {\r\n        let direction: 'asc' | 'desc' = 'asc';\r\n        if (sortConfig.key === key && sortConfig.direction === 'asc') {\r\n            direction = 'desc';\r\n        }\r\n        setSortConfig({ key, direction });\r\n    };\r\n\r\n    if (isLoading) {\r\n        return <div className=\"flex min-h-screen bg-gray-900 items-center justify-center\"><Loader2 className=\"animate-spin text-blue-500\" size={48} /></div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex min-h-screen bg-gray-900 text-gray-300\">\r\n            <aside className=\"w-64 bg-gray-950 p-6 flex-shrink-0 flex flex-col\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-white mb-8\">Docu Sphere</h1>\r\n                    <nav className=\"flex flex-col gap-4\">\r\n                        <NavLink href=\"/dashboard\" icon={<LayoutDashboard size={20} />} isActive={false}>Dashboard</NavLink>\r\n                        <NavLink href=\"/documents\" icon={<FolderKanban size={20} />} isActive={true}>Documents</NavLink>\r\n                        <NavLink href=\"#\" icon={<BarChart2 size={20} />} isActive={false}>Reports</NavLink>\r\n                        <NavLink href=\"#\" icon={<CheckSquare size={20} />} isActive={false}>Approvals</NavLink>\r\n                    </nav>\r\n                </div>\r\n                <div className=\"mt-auto\">\r\n                    <NavLink href=\"#\" icon={<Settings size={20} />} isActive={false}>Settings</NavLink>\r\n                    <NavLink href=\"/\" icon={<LogOut size={20} />} isActive={false}>Logout</NavLink>\r\n                </div>\r\n            </aside>\r\n\r\n            <main className=\"flex-1 p-8 overflow-y-auto\">\r\n                {selectedDoc && <DocumentViewerModal doc={selectedDoc} onClose={() => setSelectedDoc(null)} />}\r\n\r\n                {showUploadModal && (\r\n                    <UploadModal\r\n                        currentDept={isAdmin ? 'Admin' : deptSlug.charAt(0).toUpperCase() + deptSlug.slice(1)}\r\n                        canChooseDept={isAdmin}\r\n                        onClose={() => setShowUploadModal(false)}\r\n                        // --- (3) IMPROVE THE onUpload HANDLER ---\r\n                        onUpload={(newlyUploadedDocFromServer) => {\r\n                            // Map the single new document from the backend to our frontend type\r\n                            const mappedDoc: Document = {\r\n                                id: newlyUploadedDocFromServer.id,\r\n                                title: newlyUploadedDocFromServer.title,\r\n                                department: newlyUploadedDocFromServer.department,\r\n                                upload_date: newlyUploadedDocFromServer.upload_date ? new Date(newlyUploadedDocFromServer.upload_date).toISOString().slice(0, 10) : 'N/A',\r\n                                file_path: newlyUploadedDocFromServer.file_path,\r\n                                status: newlyUploadedDocFromServer.status,\r\n                                summary: newlyUploadedDocFromServer.summary,\r\n                                deadlines: newlyUploadedDocFromServer.deadlines || [],\r\n                                financial_terms: newlyUploadedDocFromServer.financial_terms || [],\r\n                            };\r\n                            // Add the new, confirmed document to the top of the list\r\n                            setDocuments(prev => [mappedDoc, ...prev]);\r\n                        }}\r\n                    />\r\n                )}\r\n\r\n                <header className=\"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4\">\r\n                    <div>\r\n                        <h2 className=\"text-3xl font-bold text-white\">{isAdmin ? 'All Documents' : `${deptSlug.charAt(0).toUpperCase() + deptSlug.slice(1)} Documents`}</h2>\r\n                        <p className=\"text-gray-400\">Browse, search, and manage files.</p>\r\n                    </div>\r\n                    <button onClick={() => setShowUploadModal(true)} className=\"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md flex items-center gap-2\">\r\n                        <Upload size={20} /> Upload Document\r\n                    </button>\r\n                </header>\r\n\r\n                <div className=\"flex items-center gap-4 mb-6 bg-gray-950 p-4 rounded-lg\">\r\n                    <div className=\"relative flex-grow\">\r\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500\" size={20} />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search by title...\"\r\n                            value={searchTerm}\r\n                            onChange={(e) => setSearchTerm(e.target.value)}\r\n                            className=\"bg-gray-800 border-gray-700 w-full text-white rounded-md pl-10 pr-4 py-2 focus:outline-none focus:border-blue-500\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-gray-400 text-sm\">Sort by:</span>\r\n                        <button onClick={() => requestSort('upload_date')} className=\"flex items-center gap-1 text-white hover:text-blue-400\">\r\n                            Date {sortConfig.key === 'upload_date' && (sortConfig.direction === 'asc' ? <ArrowUp size={16} /> : <ArrowDown size={16} />)}\r\n                        </button>\r\n                        <button onClick={() => requestSort('title')} className=\"flex items-center gap-1 text-white hover:text-blue-400\">\r\n                            Title {sortConfig.key === 'title' && (sortConfig.direction === 'asc' ? <ArrowUp size={16} /> : <ArrowDown size={16} />)}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <section>\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6\">\r\n                        {sortedAndFilteredDocuments.map(doc => (\r\n                            <DocumentCard\r\n                                key={doc.id}\r\n                                doc={doc}\r\n                                onClick={() => setSelectedDoc(doc)}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                    {sortedAndFilteredDocuments.length === 0 && (\r\n                        <div className=\"text-center py-16 bg-gray-800 rounded-md\">\r\n                            <p className=\"text-gray-400\">No documents found.</p>\r\n                        </div>\r\n                    )}\r\n                </section>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n\r\n\r\n// Simplified DocumentCard, as hover preview is removed for simplicity\r\nconst DocumentCard = ({ doc, onClick }: { doc: Document; onClick: () => void; }) => {\r\n    return (\r\n        <div\r\n            onClick={onClick}\r\n            className=\"bg-gray-800 p-4 rounded-lg shadow-lg flex flex-col justify-between h-48 cursor-pointer group hover:bg-gray-700 transition-colors\"\r\n        >\r\n            <div>\r\n                <FileText className=\"text-blue-400\" size={32} />\r\n                <h4 className=\"font-bold text-white mt-3 truncate group-hover:text-blue-300\">{doc.title}</h4>\r\n                <p className=\"text-sm text-gray-400\">{doc.department}</p>\r\n            </div>\r\n            <div>\r\n                <p className=\"text-xs text-gray-500\">Status: {doc.status}</p>\r\n                <p className=\"text-xs text-gray-500\">{doc.upload_date}</p>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\n// UploadModal remains mostly the same, no major changes needed here\r\nconst UploadModal = ({ onClose, onUpload, currentDept, canChooseDept }: { onClose: () => void; onUpload: (data: any) => void; currentDept: string; canChooseDept: boolean; }) => {\r\n    const [title, setTitle] = useState('');\r\n    const [file, setFile] = useState<File | null>(null);\r\n    const [dept, setDept] = useState(currentDept);\r\n    const [isUploading, setIsUploading] = useState(false);\r\n\r\n    const submit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!title.trim() || !file) {\r\n            alert('Title and file are required.');\r\n            return;\r\n        }\r\n        setIsUploading(true);\r\n        let user: any = null;\r\n        try {\r\n            user = typeof window !== 'undefined' ? JSON.parse(localStorage.getItem('kmrl_user') || 'null') : null;\r\n        } catch { }\r\n\r\n        if (!user) {\r\n            alert('Could not find user info. Please log in again.');\r\n            setIsUploading(false);\r\n            return;\r\n        }\r\n\r\n        const formData = new FormData();\r\n        formData.append('title', title.trim());\r\n        formData.append('department', dept);\r\n        formData.append('user_id', user.userId);\r\n        formData.append('file', file);\r\n\r\n        try {\r\n            const response = await fetch(`${API_BASE}/documents/upload`, {\r\n                method: 'POST',\r\n                body: formData,\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const errorData = await response.json();\r\n                throw new Error(errorData.detail || 'Upload failed');\r\n            }\r\n\r\n            const result = await response.json();\r\n            onUpload(result.document_info);\r\n            onClose();\r\n\r\n        } catch (err: any) {\r\n            alert(`Error: ${err.message}`);\r\n            console.error(err);\r\n        } finally {\r\n            setIsUploading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50\">\r\n            <div className=\"bg-gray-800 p-8 rounded-lg shadow-2xl w-full max-w-lg relative\">\r\n                <button onClick={onClose} className=\"absolute top-4 right-4 text-gray-400 hover:text-white\"><X size={24} /></button>\r\n                <h3 className=\"text-2xl font-bold text-white mb-6\">Upload New Document</h3>\r\n                <form className=\"space-y-4\" onSubmit={submit}>\r\n                    {/* Form fields remain the same */}\r\n                    <div>\r\n                        <label className=\"text-sm font-bold text-gray-400 block mb-2\">Document Title</label>\r\n                        <input value={title} onChange={(e) => setTitle(e.target.value)} type=\"text\" placeholder=\"e.g., Q4 Financial Projections\" className=\"w-full bg-gray-700 text-white rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-sm font-bold text-gray-400 block mb-2\">Department</label>\r\n                        {canChooseDept ? (\r\n                            <select value={dept} onChange={(e) => setDept(e.target.value)} className=\"w-full bg-gray-700 text-white rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500\">\r\n                                <option value=\"Finance\">Finance</option>\r\n                                <option value=\"Operations\">Operations</option>\r\n                                <option value=\"Engineering\">Engineering</option>\r\n                                <option value=\"Maintenance\">Maintenance</option>\r\n                                <option value=\"HR\">HR</option>\r\n                            </select>\r\n                        ) : (\r\n                            <input readOnly value={dept} className=\"w-full bg-gray-700 text-white rounded-md p-3\" />\r\n                        )}\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-sm font-bold text-gray-400 block mb-2\">Document File</label>\r\n                        <div className=\"border-2 border-dashed border-gray-600 rounded-md p-6 text-center relative\">\r\n                            <Upload size={40} className=\"mx-auto text-gray-500 mb-2\" />\r\n                            <p className=\"text-gray-400\">{file ? file.name : 'Drag & drop files here or click to browse'}</p>\r\n                            <input onChange={(e) => setFile(e.target.files?.[0] || null)} type=\"file\" className=\"opacity-0 absolute inset-0 w-full h-full cursor-pointer\" />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"pt-4\">\r\n                        <button type=\"submit\" disabled={isUploading} className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-md transition-colors disabled:bg-gray-500 disabled:cursor-not-allowed flex items-center justify-center gap-2\">\r\n                            {isUploading && <Loader2 className=\"animate-spin\" size={20} />}\r\n                            {isUploading ? 'Uploading...' : 'Upload Document'}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}}]
}